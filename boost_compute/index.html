<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Boost Compute</title>

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
			    <!-- ###################################################################
				     ##################################################################-->
				<section data-markdown>
					#Boost Compute
					#### Code Chat November 2016
					Anton Piccardo-Selg
				</section>
				<!-- ##################################################################
				     ##################################################################-->
				<!-- What is Boost Compute -->
				<section name ="what_is">
					<section>
					<h2> What is Boost Compute?</h2>
						<ul>
						<li> heterogenous-computing library for C++ based on <b>OpenCL</b> </li>
						<li> essentially thin C++ wrapper over the OpenCL API </li>
						<li> Windows, Mac, Linux </li>
						<li> Header only library (almost)</li>
						<li> Added to Boost (1.61) in April 2016 </li>
						</ul>
					</section>
					<section>
						<img src="boost_compute_architecture.jpg" height="100%" width="100%" style="background:none; border:none; box-shadow:none;">
						<p align="left"  style="font-size:20px">src: <a hrf"www.iwocl.org/wp-content/uploads/iwocl-2016-boost-compute.pdf">IWOCL talk by Jakub Szuppe</a></p>
					</section>
				</section>

				<!-- ##################################################################
				     ##################################################################-->
				<!-- Basic OpenCL -->
				<section name ="open_cl_basics">
				<section>
					<h2>OpenCL Concepts</h2>
				</section>
				<section>
					<h5>OpenCL Class Diagram </h5>
					<img src="open_cl_class_diagram.jpg" height="70%" width="70%" style="background:none; border:none; box-shadow:none;">
				</section>
				<section style="width:110%">
					<font size="6">
					<p style="text-align:left">Platform: </p>
					<ul>
						<li> Actual OpenCL implementation (Vendor and version specific)</li>
						<li> Example: Intel(R) OpenCL, Experimental OpenCL 2.1 CPU Only Platform</li>
					</ul>
				</font>
				<font size="6">
					<div class="fragment">
					<p style="text-align:left">Device: </p>
					<img src="memory_model.png" height="55%" width="55%" style="background:none; border:none; box-shadow:none;">
					</div>
				</font>
				</section>
				<section>
					<font size="6">
					<p style="text-align:left">Context: </p>
					<ul>
						<li> Host-device interaction </li>
						<li> Management of memory objects and keeping track of Kernels</li>
					</ul>
					<div class="fragment">
					<p style="text-align:left">Command Queue: </p>
					<ul>
						<li> Communciation with compute device</li>
						<li> Data transfer and Kernel execution sdfsfsdfsdfsdfsdfdsf</li>
					</ul>
					</div>
					<!--
					<ul>
						<li> Communciation with compute device</li>
						<li> Data transfer + Kernel execution</li>
					</ul>

					<p style="text-align:left">Program + Kernel: </p>
					<ul>
						<li> Program contains Kernels</li>
						<li> Runtime compilation (but can cache or load binaries in specialized situations).</li>
						<li> Kernel is a function which runs in parallel on compute device</li>
						<li> Kernels written in OpenCL C</li>
					</ul>
				 -->
				  </font>
				</section>
				<section>
					<font size="6">
					<p style="text-align:left">Simple Kernel for addition: </p>
					</font>
					<pre style="width:100%"><code class="cpp" data-trim contenteditable >
__kernel void add(__global float* a, __gloabl float* b, __global float* c) {
  const uint i = get_global_id(0);
  c[i] = a[i] + b[i];
}
					</code></pre>
					<font size="6">
					<p style="text-align:left">OpenCL C API Example: </p>
					</font>
<pre style="width:100%"><code class="cpp" data-trim contenteditable >
...
result = clBuildProgram(program, 0, NULL, NULL, NULL, NULL);
if (r != CL_SUCCESS) {
cl_device_id device_id [16];
clGetContextInfo(context, CL_CONTEXT_DEVICES, sizeof(device_id),
                 &device_id, NULL);
clGetProgramBuildInfo(program, device_id [0], CL_PROGRAM_BUILD_LOG,
                      sizeof(buffer) - 1, buffer, &size);
...
}
</code></pre>




				</section>
				</section>
				<!-- ##################################################################
				     ##################################################################-->
				<!-- How to integrate boost into your project -->
				<section name ="why_boost_compute" style="width:140%; left:-20%">
				 <section>
				 <h2> Getting Started </h2>
			 </section>
			 <section>
				 	<ol>
						<li> Get the OpenCL implementation for your devices, ie from Intel, AMD, ...
							<ul>
								<li>You should have a  <code>cl.hpp</code> and a corresponding OpenCL library.</li>
							</ul>
						</li>
					<div class="fragment">
						<li> Get Boost >1.61 </li>
					</div>
					<div class="fragment">
						<li> Make OpenCL available to your build
							<ul>
								<li> <code>find_package(OpenCL REQUIRED)</code> </li>
								<li> <code>include_directories(SYSTEM ${OpenCL_INCLUDE_DIRS})</code> </li>
								<li> <code>target_link_libraries(EXECUTABLE ${OpenCL_LIBRARIES})</code></li>
							</ul>
						</li>
					</div>
					<div class="fragment">
						<li>Include via:
							<ul>
								<li> <code>&ltboost/compute.hpp&gt</code> or </li>
								<li> <code>&ltboost/compute/xxx.hpp&gt</code></li>
							</ul>
						</li>
					</div>
					</ol>
				</section>
				</section>
				<!-- ###################################################################
				     ##################################################################-->
				<section name ="hello_boost_compute">
					<section>
					<h2> Using the High-Level API</h2>
					</section>
					<section name="initialize_algorihtm">
						<h5> Example: Sorting a vector</h5>
			<font size="6">
			<p style="text-align:left">Setup (simple): </p>
			<ul>
				<li> Get a compute device </li>
				<li> Setup a context </li>
				<li> Create a command queue for the compute device </li>
			</ul>
			</font>
<div class="fragment">
<pre style="width:100%"><code class="cpp" data-trim contenteditable >
#include &ltboost/compute.hpp&gt
#include &ltiostream&gt
#include &ltvector&gt

namespace compute = boost::compute;

int main() {
auto device = compute::system::default_device();
std::cout &lt&lt device.name() &lt&lt std::endl; // Intel(R) HD Graphics 4600
compute::context context(device);
compute::command_queue command_queue(context, device);

# Create a sample vector on the host
// generate random data on the host
const size_t host_vector_size = 10000;
std::vector&ltfloat&gt host_vector(host_vector_size);
std::generate(host_vector.begin(), host_vector.end(), rand);

</code></pre>
</div>
					</section>
					<section>
						<h5> Example: Sorting a vector</h5>
						<font size="6">
						<p style="text-align:left">Transfer from host to device: </p>
						<ul style="text-align:left">
							<li> Create a buffer</li>
							<li> Copy from host to device</li>
						</ul>
						</font>
				  <div class="fragment">
<pre style="width:100%"><code class="cpp" data-trim contenteditable >
compute::vector&ltfloat&gt device_vector(host_vector.size(), context);

compute::copy(host_vector.begin(),
              host_vector.end(),
              device_vector.begin(),
              queue);
</code></pre>
					</div>
					</section>
					<section>
						<h5> Example: Sorting a vector</h5>
						<font size="6">
						<p style="text-align:left">Perform the sorting: </p>
						<ul style="text-align:left">
							<li> Run the algorihtm</li>
							<li> Transfer data back to host</li>
						</ul>
						</font>
<div class="fragment">

<pre style="width:100%"><code class="cpp" data-trim contenteditable >
compute::sort(device_vector.begin(), device_vector.end(), queue);

compute::copy(device_vector.begin(),
              device_vector.end(),
              host_vector.begin(),
              queue);

return 0;
}
</code></pre>
</div>
					</section>
					<section>
						<h5><a href="http://www.boost.org/doc/libs/1_61_0/libs/compute/doc/html/boost_compute/reference.html#boost_compute.reference.api_overview">compute::algorithm API</a></h5>
					</section>
					<section>
					<h5> Other features</h5>
					<font size="6">
					<p style="text-align:left">Functions, Closures, Lambdas: </p>
					</font>
					<pre style="width:120%"><code class="cpp" data-trim contenteditable >
float cutoff = 42.0;
BOOST_COMPUTE_CLOSURE(bool, is_smaller, (float value), (cutoff),
{
    return value &lt cutoff;
});

auto all_elements_smaller =
         boost::compute::all_of(device_vector.begin(),
                                device_vector.end(),
                                is_smaller, queue);

					</code></pre>
					<div class="fragment">
					<pre style="width:120%"><code class="cpp" data-trim contenteditable >
boost::compute::function&ltbool(float)&gt is_smaller_2 =
                                return boost::compute::lambda::_1 &lt cutoff;
auto all_elements_smaller2 =
          boost::compute::all_of(vectors.begin(),
                                 vectors.end(),
                                 is_smaller_2,
                                 queue);

					</code></pre>
				  </div>
					</section>
					<section>
						<h5> Other features</h5>
						<font size="6">
						<ul>
							<li> Asynchronous data transfer</li>
							<li> Vectorized data </li>
							<li> Iterators (e.g. zip iterator) </li>
							<li> ... </li>
						</font>
					</section>
				</section>
				<!-- ###################################################################
						 ##################################################################-->
				<section name ="low_level_algorithms">
					<h2> Low-level approach</h2>

				</section>
				<!-- ###################################################################
						 ##################################################################-->
				<section name ="performance">
					<h2> Performance</h2>

				</section>
				<!-- ###################################################################
				     ##################################################################-->
				<!-- End -->
				<section>
				<h3>End</h3>
				</section>
				<!-- ###################################################################
					  END OF SECTIONS
				     ##################################################################-->
			</div>
		</div>
		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>
		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'convex', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
